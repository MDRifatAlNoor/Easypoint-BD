<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Login | Easypoint BD</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  font-family:Montserrat,sans-serif;
}
.login-box{
  background:#fff;
  padding:40px;
  border-radius:15px;
  width:100%;
  max-width:400px;
  box-shadow:0 20px 40px rgba(0,0,0,.3);
}
</style>
</head>
<body>

<div class="login-box">
  <h3 class="text-center mb-4">User Login</h3>

  <input 
    id="email" 
    type="email" 
    class="form-control mb-3" 
    placeholder="Enter your email" 
    required
  >

  <input 
    id="password" 
    type="password" 
    class="form-control mb-3" 
    placeholder="Enter your password" 
    required
  >

  <div class="form-check mb-3">
    <input class="form-check-input" type="checkbox" id="showPassword">
    <label class="form-check-label">Show Password</label>
  </div>

  <button class="btn btn-primary w-100" onclick="loginUser()">Login</button>

  <p id="error" class="text-danger mt-3 text-center"></p>

  <p class="text-center mt-3">
    Donâ€™t have an account? <a href="signup.html">Sign Up</a>
  </p>
</div>

<!-- Firebase Authentication -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyApZK1uKspkk_yu8mCKDH44rDnmJzjvv00",
  authDomain: "myshop-f7a03.firebaseapp.com",
  projectId: "myshop-f7a03",
  storageBucket: "myshop-f7a03.appspot.com",
  messagingSenderId: "793564064034",
  appId: "1:793564064034:web:fcc5230ff28a5ee8005d7b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// show / hide password
document.getElementById("showPassword").addEventListener("change", function(){
  document.getElementById("password").type = this.checked ? "text" : "password";
});

function showError(msg){
  document.getElementById("error").innerText = msg;
}

window.loginUser = function(){
  const email = document.getElementById("email").value.trim().toLowerCase();
  const password = document.getElementById("password").value;

  if(!email || !password){
    showError("All fields are required");
    return;
  }

  signInWithEmailAndPassword(auth, email, password)
    .then((userCredential) => {
      // login success
      const user = userCredential.user;

      // Optional: you can save login state locally if needed
      localStorage.setItem("userLoggedIn", "true");
      localStorage.setItem("userEmail", user.email);

      window.location.href = "user-dashboard.html";
    })
    .catch((error) => {
      showError("Invalid email or password!");
      console.error(error);
    });
};

// Optional: Redirect if already logged in
onAuthStateChanged(auth, (user) => {
  if(user){
    window.location.href = "user-dashboard.html";
  }
});
</script>

</body>
</html>