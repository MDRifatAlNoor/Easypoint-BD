<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Easypoint BD | Sign In</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
  font-family:'Montserrat',sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.login-box{
  background:#fff;
  padding:40px;
  border-radius:15px;
  width:100%;
  max-width:400px;
  box-shadow:0 20px 40px rgba(0,0,0,.3);
}
</style>
</head>

<body>

<div class="login-box">
  <h3 class="text-center mb-4">User Login</h3>

  <input 
    id="loginEmail" 
    type="email" 
    class="form-control mb-3" 
    placeholder="Enter your Gmail"
  >

  <input 
    id="loginPassword" 
    type="password" 
    class="form-control mb-3" 
    placeholder="Enter your password"
  >

  <div class="form-check mb-3">
    <input class="form-check-input" type="checkbox" id="showPassword">
    <label class="form-check-label" for="showPassword">Show Password</label>
  </div>

  <button class="btn btn-primary w-100" id="loginBtn">Login</button>

  <p id="error" class="text-danger mt-3 text-center"></p>

  <p class="text-center mt-3" >
    Don't have an account? <a href="sign.html" style="text-decoration: none;"><b>Sign up</b></a>
  </p>
</div>

<!-- ================= FIREBASE LOGIN ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { 
  getAuth,
  signInWithEmailAndPassword,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyApZK1uKspkk_yu8mCKDH44rDnmJzjvv00",
  authDomain: "myshop-f7a03.firebaseapp.com",
  projectId: "myshop-f7a03",
  storageBucket: "myshop-f7a03.firebasestorage.app",
  messagingSenderId: "793564064034",
  appId: "1:793564064034:web:fcc5230ff28a5ee8005d7b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* SHOW / HIDE PASSWORD */
document.getElementById("showPassword").addEventListener("change", function(){
  document.getElementById("loginPassword").type = this.checked ? "text" : "password";
});

/* LOGIN */
document.getElementById("loginBtn").addEventListener("click", async () => {
  const email = loginEmail.value.trim();
  const password = loginPassword.value;
  const error = document.getElementById("error");
  error.innerText = "";

  if (!email || !password) {
    error.innerText = "Please enter email and password";
    return;
  }

  try {
    await signInWithEmailAndPassword(auth, email, password);
    window.location.href = "user-dashboard.html";
  } catch (err) {
    if (err.code === "auth/user-not-found") {
      error.innerText = "Email not registered";
    } else if (err.code === "auth/wrong-password") {
      error.innerText = "Incorrect password";
    } else {
      error.innerText = err.message;
    }
  }
});

/* AUTO REDIRECT IF ALREADY LOGGED IN */
onAuthStateChanged(auth, (user) => {
  if (user) {
    window.location.href = "user-dashboard.html";
  }
});
</script>

</body>
</html>